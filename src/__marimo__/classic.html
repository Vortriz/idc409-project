<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>classic.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>classic</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/index-DppOWifW.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/preload-helper-BpItL31i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/react-BcIddLXZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/jsx-runtime-DvsdsEjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useEventListener-C5BS4xuN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/react-dom-D6bRRS5R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/tslib.es6-sakIzgHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/Combination-DR4iFoRS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/cn-C5VTNYKf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/menu-items-DOc2hwO2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/hotkeys-Lbk6RHir.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/button-nRVaalxL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-Cei_8ikW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/createLucideIcon-DA8ZBm4D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/check-BUgsJwxM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/select-DJ0A_oCR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/accordion-BlX0p_kD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/chevron-right-WxQzIptp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dropdown-menu-1SGi7wHR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/tooltip-BQKXsEoT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_baseIsEqual-BF8660ot.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/jotai-DDOP7CKM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/invariant-DPGusy7Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/merge-BgA7kxZb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/utils-DnJCRgaX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/requests-D3Z6okhb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/once-Co7xi2Ip.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/toDate-sQp07c5U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_baseSlice-B27Cqkm6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_hasUnicode-CPHpt5EV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/upperFirst-DOlTOwhh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/capitalize-CkrfIDeS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/ai-model-dropdown-CtXN4x7s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/badge-CFi0nvIx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/use-toast-BiL_AQz9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/constants-DIZnpo2K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/Deferred-zIiWPYX3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/config-BjdJmdrN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/uuid-Dj56ryH_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/key-DWQdrH_J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/connection-DnLUBy9M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useLifecycle-CuZnZLRp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useNonce-DECX9FAH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useTheme-BMknLtnH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/capabilities-DdXtcIOa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/createReducer-80xvKyHq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-BPcMnGQn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-C13bkrcz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-pZAIwcZo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-Ba10OKR3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-D-CsU-_R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-DBeOBCHw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-DZNGKufD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-ClBFnEcy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-Q3T6mWQ0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/stex-LEaAsvUb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_baseProperty-CIKnF2iY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/now-B6JN1xKT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/debounce-70y9MzDK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/type-Cpth3na1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/marked.esm-DCf1d_lA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/main-CD7jouuS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/cells-B6jS0AIj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/kbd-CZFOBQmt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/renderShortcut-GP8-boTA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useEvent-d8iQXgui.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useDeleteCell-BSTJX7_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/icons-j8BJ30se.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useRunCells-uzADaSkg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/alert-dialog-DM1h8RhU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dialog-CEqVOFHc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useDebounce-BDmbJDbT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/numbers-Hxwz5HuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/context-BMtIGcq8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useNumberFormatter-DynX1ecE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/input-BPw9p_8N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/ImperativeModal-CmOSTULR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/cell-link-D9FNaXGs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/spinner-FaMZ5NTl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/datasource-CzmVjgw7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/add-missing-import-BJfCTctT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/ansi_up-HmF1kpkv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/blob-COEMBEnt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dom-DaBOvHqM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/errors-5BnWGoql.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/extends-C-tvimwN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/objectWithoutPropertiesLoose-DDvr5cHq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/esm-ChGlv0th.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/es-Bvr8zSR1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/play-BOSd7i5f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/sparkles-CyIU0Xy_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/shim-Bk8nzKPV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/add-cell-with-ai-DsqPH829.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/ErrorBoundary-7JQlouA1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/alert-CBA2m-3_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/links-DCKgyNFq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/state-CMOQfD_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/MarimoErrorOutput-okxire5Y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/copy-DAqXDCGN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/copy-CWjpIcfl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/copy-icon-5DWltDxB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/mode-BdfAcJv1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/purify.es-D83HMRRD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/RenderHTML-CUSvJfTV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/emotion-is-prop-valid.esm-BgfwcIY_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/with-selector-B_mpCvmo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/delay-mount-BvJt70jv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_arrayReduce-DDpPg0Qh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/startCase-DOk4LYuA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/strings-DSmr2a_p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/command-BqJiTpIC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/popover-BM0PuIZH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/table-mB7CFPse.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/tabs-CwHEUPW2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useAsyncData-CsBCDF11.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useIframeCapabilities-w06PAeNM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/error-banner-RIuTelB8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/defaultLocale-DEOAvdte.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/precisionRound-BIK1W-Pu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/defaultLocale-Ca1Ci3kv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/vega-loader.browser.module-B-icPEAc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/loader-g7OmFu5O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/formats-Q84dqqph.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/en-US-CUvYxyLA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/isValid-BcG0nMKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dates-CSR6KU2P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/download-C6eeMKzw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/maps-C9sj23qe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useDateFormatter-B6Y_k710.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/range-CPekNdzi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/list-filter-pQvV7yyl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/columns-BnRpK2Sj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/focus-NSCHuycv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useInstallPackage-RVnGhNcD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/column-preview-ChwjCH-u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useAddCell-BcZiZJfL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/toggle-JGbyXN73.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useHotkey-BxEtU0rE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/globals-CqGdf2Mu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/share-H7Fnb7dX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/dist-CIi_Q6L4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/memoize-CAcr7Wct.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_toKey-Di_xoXjD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_baseSet-BlAtwuhp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/utilities.esm-BkSvpyq-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/floating-outline-CUjFOfng.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/eye-off-Dyzb-Ibf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/plus-CmzxQYgQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/readonly-python-code-CViHfG5I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/file-video-camera-DxgiJa0r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/file-text-Cng4_CT2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/file-CEq0dl8f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/types-BT_Kor11.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/label-6DIjJ2sP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/form-b4A0F_Lr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/textarea-CuEW04Ze.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/circle-x-DGA84U3r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/refresh-ccw-q_wAM7pz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/trash-2-DtsdG6Pf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/form-CDF8FirJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/field-XT1d7zKu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/switch-CEMEIJww.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useBoolean-B-LYLCcg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/useDeepCompareMemoize-sbXO3Z1K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/LazyAnyLanguageCodeMirror-PGusm5pp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/types-DZTeU1k8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/prop-types-BdSU55sL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/es-xBjOufca.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/VisuallyHidden-DioJ3bf_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_baseFlatten-8yEsQJi9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/get-BYzWDFJH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/hasIn-WaG0qjy7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/_basePickBy-W59-WIft.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/pick-Ck1LTYI3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/square-CF_LAdAS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/chart-no-axes-column-CQryi5Zm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/download-B7wrfIWv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/globe-BwmpFahE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/send-BWOx6HDI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/refresh-cw-9lSVG80g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/settings-BR_jkuLF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/square-function-DVIoLDaU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/bundle.esm-DY-5mqxG.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/columns-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.2/dist/assets/index-B8ySTPp_.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "classic.py",
            "mode": "read",
            "version": "0.17.2",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 16, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"auto_download": ["html", "ipynb"], "sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "# Initialization code that runs before all other cells\nimport os\nimport joblib\nfrom collections import Counter\n\nimport cv2\nimport numpy as np\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import accuracy_score, classification_report\n\nimport matplotlib.pyplot as plt\n\nimport marimo as mo", "code_hash": "605789aadee6b5f930c872b526432965", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "setup", "name": "setup"}, {"code": "mo.md(r\"\"\"# Model\"\"\")", "code_hash": "bf36fea9dba95b6a79c2c932a5f03656", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hbol", "name": "_"}, {"code": "def preprocessing(image_path, threshold_value=None):\n    image = cv2.imread(image_path)\n    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n    blur = cv2.GaussianBlur(gray, (5, 5), 0)  # to reduce noise\n\n    # threshold the image to convert to binary\n    if threshold_value is None:\n        threshold_value = np.max(blur) / 2 + np.min(blur) / 2\n    _, thresholded_image = cv2.threshold(\n        blur, threshold_value, 255, cv2.THRESH_BINARY_INV\n    )\n\n    return thresholded_image", "code_hash": "dc47c3a36148a4dfe2ef48d418acdcb5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "*preprocessing"}, {"code": "def find_contour(thresholded_image):\n    contours, _ = cv2.findContours(\n        thresholded_image, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE\n    )\n\n    if not contours:\n        return None\n\n    # assume the largest contour is our shape\n    contour = max(contours, key=cv2.contourArea)\n\n    # filter out tiny contours that are likely noise\n    if cv2.contourArea(contour) \u003C 100:\n        return None\n\n    return contour", "code_hash": "9ff6cad46213888800b73a856ce45207", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "*find_contour"}, {"code": "def extract_features_from_contour(contour):\n    # Hu moments\n    M = cv2.moments(contour)\n\n    if M[\"m00\"] == 0:\n        return None  # avoid divide-by-zero\n\n    hu_moments = cv2.HuMoments(M).flatten()\n    # to make them more stable and comparable\n    hu_moments = (\n        -1 * np.copysign(1.0, hu_moments) * np.log10(abs(hu_moments) + 1e-7)\n    )\n\n    # corners\n    perimeter = cv2.arcLength(contour, True)\n    epsilon = (\n        0.03 * perimeter\n    )  # 3% of perimeter is a good starting point for approximation\n    approx = cv2.approxPolyDP(contour, epsilon, True)\n    num_corners = len(approx)\n\n    # solidity\n    area = M[\"m00\"]  # cv2.contourArea(contour)\n    hull = cv2.convexHull(contour)\n    hull_area = cv2.contourArea(hull)\n    solidity = float(area) / hull_area if hull_area \u003E 0 else 0\n\n    # aspect ratio\n    x, y, w, h = cv2.boundingRect(contour)\n    aspect_ratio = float(w) / h if h \u003E 0 else 0\n\n    # circularity\n    circularity = (4 * np.pi * area) / (perimeter**2) if perimeter \u003E 0 else 0\n\n    # final feature vector\n    features = np.append(\n        [num_corners, solidity, aspect_ratio, circularity], hu_moments\n    )\n\n    return features", "code_hash": "2902443dcef389380f132d2fbbac281f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "*extract_features_from_contour"}, {"code": "def extract_features(image_path):\n    thresholded_image = preprocessing(image_path)\n    contour = find_contour(thresholded_image)\n    if contour is None:\n        return None\n    features = extract_features_from_contour(contour)\n\n    return features", "code_hash": "1acd1a01ba34e9052e4e63390b21cde6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "*extract_features"}, {"code": "@mo.cache\ndef load_data(dataset_path, labels):\n    all_features = []\n    all_labels = []\n\n    feature_names = [\n        \"num_corners\",\n        \"solidity\",\n        \"aspect_ratio\",\n        \"circularity\",\n        \"hu1\",\n        \"hu2\",\n        \"hu3\",\n        \"hu4\",\n        \"hu5\",\n        \"hu6\",\n        \"hu7\",\n    ]\n\n    for label in mo.status.progress_bar(\n        labels, title=f\"Loading dataset of {len(labels)} labels\"\n    ):\n        label_path = os.path.join(dataset_path, label)\n        if not os.path.isdir(label_path):\n            print(f\"Warning: Label directory not found: {label_path}\")\n            continue\n\n        for filename in mo.status.progress_bar(\n            os.listdir(label_path),\n            title=f\"Extracting features for label '{label}'\",\n            remove_on_exit=True,\n        ):\n            if filename.endswith(\".png\"):\n                image_path = os.path.join(label_path, filename)\n                features = extract_features(image_path)\n\n                if features is not None and len(features) == len(\n                    feature_names\n                ):\n                    all_features.append(features)\n                    all_labels.append(label)\n\n    df = pd.DataFrame(all_features, columns=feature_names)\n    df[\"label\"] = all_labels\n\n    return df", "code_hash": "ff1d8188db49140f32f76b77ed62e37a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "*load_data"}, {"code": "mo.md(r\"\"\"# Evaluation\"\"\")", "code_hash": "32b37a5409d34d88adb720646705ec80", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "DATASET_DIR = mo.notebook_dir() / \"dataset_classic\"\nLABELS = [\n    \"parallelogram\",\n    \"triangle\",\n    \"pentagon\",\n    \"rectangle\",\n    \"square\",\n    \"circle\",\n    \"trapezoid\",\n    \"oval\",\n    \"semicircle\",\n    \"rhombus\",\n]\n\ndata = load_data(DATASET_DIR, LABELS)\n\nmo.stop(data.empty, mo.md(\"**Error**: No data was loaded. Exiting!\"))\nmo.output.append(\n    mo.md(f\"Successfully loaded and processed **{len(data)}** samples.\")\n)", "code_hash": "7e61d79b2d858b8320f60c1eb0737efd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "X = data.drop(\"label\", axis=1)\ny = data[\"label\"]\n\n# scale features\n# this is important for SVM, but also good practice for most models\n# scaler = StandardScaler()\n\nX_train, X_test, y_train, y_test = train_test_split(\n    X,\n    y,\n    test_size=0.2,\n    random_state=42,\n    stratify=y,  # to ensure all classes are represented in train/test splits\n)\n\n# X_train = scaler.fit_transform(X_train)\n# X_test = scaler.transform(X_test)", "code_hash": "f3241b8c928afc12193d2d179c52a4af", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "X", "code_hash": "02129bb861061d1a052c592e2dc6b383", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bUrD", "name": "_"}, {"code": "mo.output.append(\"Training Random Forest classifier...\")\nmodel = RandomForestClassifier(n_estimators=100, random_state=42)\n# print(\"Training SVM classifier...\")\n# model = SVC(kernel='rbf', probability=True, random_state=42)\nmodel.fit(X_train, y_train)\nmo.output.append(\"Training complete.\")", "code_hash": "5768f70e57270556cd1680b4a206347c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "y_pred = model.predict(X_test)\nacc = accuracy_score(y_test, y_pred)\nmo.output.append(mo.md(f\"Model Accuracy: **{acc * 100:.2f}%**\"))", "code_hash": "721e15e2f72632adcdde46c1ccde81dd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "mo.output.append(mo.md(\"**Classification Report:**\"))\nprint(classification_report(y_test, y_pred, labels=LABELS))", "code_hash": "af3b30e17d8db81f6024f56e09581334", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "def find_all_contours(thresholded_image):\n    contours, _ = cv2.findContours(\n        thresholded_image, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE\n    )\n\n    filtered_contours = [\n        contour for contour in contours if cv2.contourArea(contour) \u003E= 100\n    ]\n\n    return filtered_contours", "code_hash": "17b80eb12a0cf3cce7695c4f27056a58", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "*find_all_contours"}, {"code": "def extract_features_from_all_shapes(image_path, threshold_value=None):\n    feature_names = [\n        \"num_corners\",\n        \"solidity\",\n        \"aspect_ratio\",\n        \"circularity\",\n        \"hu1\",\n        \"hu2\",\n        \"hu3\",\n        \"hu4\",\n        \"hu5\",\n        \"hu6\",\n        \"hu7\",\n    ]\n    \n    thresholded_image = preprocessing(image_path, threshold_value)\n    contours = find_all_contours(thresholded_image)\n    mo.output.append(f\"Found {len(contours)} contours in the image.\")\n    \n    if len(contours) == 0:\n        return None\n\n    all_contours_features = []\n    for contour in contours:\n        all_contours_features.append(extract_features_from_contour(contour))\n\n    df = pd.DataFrame(all_contours_features, columns=feature_names)\n\n    return df", "code_hash": "63a15520ed2b467c731a22fbef57a8f8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "*extract_features_from_all_shapes"}, {"code": "multi_shape_image = mo.notebook_dir() / \"shapes_used.jpeg\"\nall_shapes_features = extract_features_from_all_shapes(\n    multi_shape_image, threshold_value=250\n)\npredicted_shapes = model.predict(all_shapes_features)\nCounter(predicted_shapes)", "code_hash": "21dc93daf437a7b185a79c3a8e5adc04", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}], "metadata": {"marimo_version": "0.17.2"}, "version": "1"},
            "session": {"cells": [{"code_hash": "605789aadee6b5f930c872b526432965", "console": [], "id": "setup", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "bf36fea9dba95b6a79c2c932a5f03656", "console": [], "id": "Hbol", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"model\"\u003EModel\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "dc47c3a36148a4dfe2ef48d418acdcb5", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "9ff6cad46213888800b73a856ce45207", "console": [], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "2902443dcef389380f132d2fbbac281f", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1acd1a01ba34e9052e4e63390b21cde6", "console": [], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ff1d8188db49140f32f76b77ed62e37a", "console": [], "id": "PKri", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "32b37a5409d34d88adb720646705ec80", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"evaluation\"\u003EEvaluation\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "7e61d79b2d858b8320f60c1eb0737efd", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-progress data-title='\u0026quot;Loading dataset of 10 labels\u0026quot;' data-total='10' data-progress='10' data-rate='0.08' data-eta='0.0'\u003E\u003C/marimo-progress\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ESuccessfully loaded and processed \u003Cstrong\u003E120000\u003C/strong\u003E samples.\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "f3241b8c928afc12193d2d179c52a4af", "console": [], "id": "BYtC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "02129bb861061d1a052c592e2dc6b383", "console": [], "id": "bUrD", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='bUrD-0' random-id='ba2e2000-612f-348f-2d81-3ecd7ddd4f1e'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9932595701,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.3333333333,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6445102649,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6684642629,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.7383069147,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:-7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:-7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9910744936,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.4358974359,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6208107108,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6586770524,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.6905102784,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9940087146,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.2533333333,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6553384859,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6750342879,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.7723044725,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:-7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:-7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9915576192,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.4285714286,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6295648429,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6617286055,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.7049798696,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:-7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9943679599,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.4146341463,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6260445571,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6617173398,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.7046628763,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:-7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:-7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9934831461,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.3134328358,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6475703142,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6696947566,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.7445703709,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:-7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:-7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9942971486,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.2957746479,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6503000281,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6707155965,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.7498084775,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:-7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:-7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9912909836,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.4222222222,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6282424695,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6636336123,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.7140803124,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:-7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:-7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9936454141,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.3043478261,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.648973028,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6701930233,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.7471234772,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:7.0},{\u0026#92;\u0026quot;num_corners\u0026#92;\u0026quot;:4.0,\u0026#92;\u0026quot;solidity\u0026#92;\u0026quot;:0.9920777818,\u0026#92;\u0026quot;aspect_ratio\u0026#92;\u0026quot;:2.3962264151,\u0026#92;\u0026quot;circularity\u0026#92;\u0026quot;:0.6349514575,\u0026#92;\u0026quot;hu1\u0026#92;\u0026quot;:0.6640546635,\u0026#92;\u0026quot;hu2\u0026#92;\u0026quot;:1.716300736,\u0026#92;\u0026quot;hu3\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu4\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu5\u0026#92;\u0026quot;:-7.0,\u0026#92;\u0026quot;hu6\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;hu7\u0026#92;\u0026quot;:-7.0}]\u0026quot;' data-total-rows='120000' data-total-columns='11' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;num_corners\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;solidity\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;aspect_ratio\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;circularity\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hu1\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hu2\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hu3\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hu4\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hu5\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hu6\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hu7\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "5768f70e57270556cd1680b4a206347c", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan\u003ETraining Random Forest classifier...\u003C/span\u003E\u003Cspan\u003ETraining complete.\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "721e15e2f72632adcdde46c1ccde81dd", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EModel Accuracy: \u003Cstrong\u003E99.09%\u003C/strong\u003E\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "af3b30e17d8db81f6024f56e09581334", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "               precision    recall  f1-score   support\n\nparallelogram       1.00      1.00      1.00      2400\n     triangle       1.00      1.00      1.00      2400\n     pentagon       1.00      1.00      1.00      2400\n    rectangle       1.00      1.00      1.00      2400\n       square       0.97      0.94      0.95      2400\n       circle       1.00      1.00      1.00      2400\n    trapezoid       1.00      1.00      1.00      2400\n         oval       1.00      1.00      1.00      2400\n   semicircle       1.00      1.00      1.00      2400\n      rhombus       0.94      0.97      0.96      2400\n\n     accuracy                           0.99     24000\n    macro avg       0.99      0.99      0.99     24000\n weighted avg       0.99      0.99      0.99     24000\n\n", "type": "stream"}], "id": "emfo", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EClassification Report:\u003C/strong\u003E\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "17b80eb12a0cf3cce7695c4f27056a58", "console": [], "id": "Hstk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "63a15520ed2b467c731a22fbef57a8f8", "console": [], "id": "nWHF", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "21dc93daf437a7b185a79c3a8e5adc04", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "\u003Cpre style='font-size: 12px'\u003ECounter({\u0026#x27;circle\u0026#x27;: 3, \u0026#x27;triangle\u0026#x27;: 3, \u0026#x27;pentagon\u0026#x27;: 2, \u0026#x27;oval\u0026#x27;: 1, \u0026#x27;parallelogram\u0026#x27;: 1})\u003C/pre\u003E"}, "type": "data"}]}], "metadata": {"marimo_version": "0.17.2"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.2%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22%2C%20auto_download%3D%5B%22html%22%2C%20%22ipynb%22%5D)%0A%0Awith%20app.setup%3A%0A%20%20%20%20%23%20Initialization%20code%20that%20runs%20before%20all%20other%20cells%0A%20%20%20%20import%20os%0A%20%20%20%20import%20joblib%0A%20%20%20%20from%20collections%20import%20Counter%0A%0A%20%20%20%20import%20cv2%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20from%20sklearn.model_selection%20import%20train_test_split%0A%20%20%20%20from%20sklearn.preprocessing%20import%20StandardScaler%0A%20%20%20%20from%20sklearn.ensemble%20import%20RandomForestClassifier%0A%20%20%20%20from%20sklearn.svm%20import%20SVC%0A%20%20%20%20from%20sklearn.metrics%20import%20accuracy_score%2C%20classification_report%0A%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%0A%20%20%20%20import%20marimo%20as%20mo%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_()%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Model%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.function%0Adef%20preprocessing(image_path%2C%20threshold_value%3DNone)%3A%0A%20%20%20%20image%20%3D%20cv2.imread(image_path)%0A%20%20%20%20gray%20%3D%20cv2.cvtColor(image%2C%20cv2.COLOR_BGR2GRAY)%0A%20%20%20%20blur%20%3D%20cv2.GaussianBlur(gray%2C%20(5%2C%205)%2C%200)%20%20%23%20to%20reduce%20noise%0A%0A%20%20%20%20%23%20threshold%20the%20image%20to%20convert%20to%20binary%0A%20%20%20%20if%20threshold_value%20is%20None%3A%0A%20%20%20%20%20%20%20%20threshold_value%20%3D%20np.max(blur)%20%2F%202%20%2B%20np.min(blur)%20%2F%202%0A%20%20%20%20_%2C%20thresholded_image%20%3D%20cv2.threshold(%0A%20%20%20%20%20%20%20%20blur%2C%20threshold_value%2C%20255%2C%20cv2.THRESH_BINARY_INV%0A%20%20%20%20)%0A%0A%20%20%20%20return%20thresholded_image%0A%0A%0A%40app.function%0Adef%20find_contour(thresholded_image)%3A%0A%20%20%20%20contours%2C%20_%20%3D%20cv2.findContours(%0A%20%20%20%20%20%20%20%20thresholded_image%2C%20cv2.RETR_EXTERNAL%2C%20cv2.CHAIN_APPROX_SIMPLE%0A%20%20%20%20)%0A%0A%20%20%20%20if%20not%20contours%3A%0A%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%23%20assume%20the%20largest%20contour%20is%20our%20shape%0A%20%20%20%20contour%20%3D%20max(contours%2C%20key%3Dcv2.contourArea)%0A%0A%20%20%20%20%23%20filter%20out%20tiny%20contours%20that%20are%20likely%20noise%0A%20%20%20%20if%20cv2.contourArea(contour)%20%3C%20100%3A%0A%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20return%20contour%0A%0A%0A%40app.function%0Adef%20extract_features_from_contour(contour)%3A%0A%20%20%20%20%23%20Hu%20moments%0A%20%20%20%20M%20%3D%20cv2.moments(contour)%0A%0A%20%20%20%20if%20M%5B%22m00%22%5D%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20return%20None%20%20%23%20avoid%20divide-by-zero%0A%0A%20%20%20%20hu_moments%20%3D%20cv2.HuMoments(M).flatten()%0A%20%20%20%20%23%20to%20make%20them%20more%20stable%20and%20comparable%0A%20%20%20%20hu_moments%20%3D%20(%0A%20%20%20%20%20%20%20%20-1%20*%20np.copysign(1.0%2C%20hu_moments)%20*%20np.log10(abs(hu_moments)%20%2B%201e-7)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20corners%0A%20%20%20%20perimeter%20%3D%20cv2.arcLength(contour%2C%20True)%0A%20%20%20%20epsilon%20%3D%20(%0A%20%20%20%20%20%20%20%200.03%20*%20perimeter%0A%20%20%20%20)%20%20%23%203%25%20of%20perimeter%20is%20a%20good%20starting%20point%20for%20approximation%0A%20%20%20%20approx%20%3D%20cv2.approxPolyDP(contour%2C%20epsilon%2C%20True)%0A%20%20%20%20num_corners%20%3D%20len(approx)%0A%0A%20%20%20%20%23%20solidity%0A%20%20%20%20area%20%3D%20M%5B%22m00%22%5D%20%20%23%20cv2.contourArea(contour)%0A%20%20%20%20hull%20%3D%20cv2.convexHull(contour)%0A%20%20%20%20hull_area%20%3D%20cv2.contourArea(hull)%0A%20%20%20%20solidity%20%3D%20float(area)%20%2F%20hull_area%20if%20hull_area%20%3E%200%20else%200%0A%0A%20%20%20%20%23%20aspect%20ratio%0A%20%20%20%20x%2C%20y%2C%20w%2C%20h%20%3D%20cv2.boundingRect(contour)%0A%20%20%20%20aspect_ratio%20%3D%20float(w)%20%2F%20h%20if%20h%20%3E%200%20else%200%0A%0A%20%20%20%20%23%20circularity%0A%20%20%20%20circularity%20%3D%20(4%20*%20np.pi%20*%20area)%20%2F%20(perimeter**2)%20if%20perimeter%20%3E%200%20else%200%0A%0A%20%20%20%20%23%20final%20feature%20vector%0A%20%20%20%20features%20%3D%20np.append(%0A%20%20%20%20%20%20%20%20%5Bnum_corners%2C%20solidity%2C%20aspect_ratio%2C%20circularity%5D%2C%20hu_moments%0A%20%20%20%20)%0A%0A%20%20%20%20return%20features%0A%0A%0A%40app.function%0Adef%20extract_features(image_path)%3A%0A%20%20%20%20thresholded_image%20%3D%20preprocessing(image_path)%0A%20%20%20%20contour%20%3D%20find_contour(thresholded_image)%0A%20%20%20%20if%20contour%20is%20None%3A%0A%20%20%20%20%20%20%20%20return%20None%0A%20%20%20%20features%20%3D%20extract_features_from_contour(contour)%0A%0A%20%20%20%20return%20features%0A%0A%0A%40app.function%0A%40mo.cache%0Adef%20load_data(dataset_path%2C%20labels)%3A%0A%20%20%20%20all_features%20%3D%20%5B%5D%0A%20%20%20%20all_labels%20%3D%20%5B%5D%0A%0A%20%20%20%20feature_names%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22num_corners%22%2C%0A%20%20%20%20%20%20%20%20%22solidity%22%2C%0A%20%20%20%20%20%20%20%20%22aspect_ratio%22%2C%0A%20%20%20%20%20%20%20%20%22circularity%22%2C%0A%20%20%20%20%20%20%20%20%22hu1%22%2C%0A%20%20%20%20%20%20%20%20%22hu2%22%2C%0A%20%20%20%20%20%20%20%20%22hu3%22%2C%0A%20%20%20%20%20%20%20%20%22hu4%22%2C%0A%20%20%20%20%20%20%20%20%22hu5%22%2C%0A%20%20%20%20%20%20%20%20%22hu6%22%2C%0A%20%20%20%20%20%20%20%20%22hu7%22%2C%0A%20%20%20%20%5D%0A%0A%20%20%20%20for%20label%20in%20mo.status.progress_bar(%0A%20%20%20%20%20%20%20%20labels%2C%20title%3Df%22Loading%20dataset%20of%20%7Blen(labels)%7D%20labels%22%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20label_path%20%3D%20os.path.join(dataset_path%2C%20label)%0A%20%20%20%20%20%20%20%20if%20not%20os.path.isdir(label_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Warning%3A%20Label%20directory%20not%20found%3A%20%7Blabel_path%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20for%20filename%20in%20mo.status.progress_bar(%0A%20%20%20%20%20%20%20%20%20%20%20%20os.listdir(label_path)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Df%22Extracting%20features%20for%20label%20'%7Blabel%7D'%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20remove_on_exit%3DTrue%2C%0A%20%20%20%20%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20filename.endswith(%22.png%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20image_path%20%3D%20os.path.join(label_path%2C%20filename)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20features%20%3D%20extract_features(image_path)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20features%20is%20not%20None%20and%20len(features)%20%3D%3D%20len(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20feature_names%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_features.append(features)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_labels.append(label)%0A%0A%20%20%20%20df%20%3D%20pd.DataFrame(all_features%2C%20columns%3Dfeature_names)%0A%20%20%20%20df%5B%22label%22%5D%20%3D%20all_labels%0A%0A%20%20%20%20return%20df%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_()%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Evaluation%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20DATASET_DIR%20%3D%20mo.notebook_dir()%20%2F%20%22dataset_classic%22%0A%20%20%20%20LABELS%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22parallelogram%22%2C%0A%20%20%20%20%20%20%20%20%22triangle%22%2C%0A%20%20%20%20%20%20%20%20%22pentagon%22%2C%0A%20%20%20%20%20%20%20%20%22rectangle%22%2C%0A%20%20%20%20%20%20%20%20%22square%22%2C%0A%20%20%20%20%20%20%20%20%22circle%22%2C%0A%20%20%20%20%20%20%20%20%22trapezoid%22%2C%0A%20%20%20%20%20%20%20%20%22oval%22%2C%0A%20%20%20%20%20%20%20%20%22semicircle%22%2C%0A%20%20%20%20%20%20%20%20%22rhombus%22%2C%0A%20%20%20%20%5D%0A%0A%20%20%20%20data%20%3D%20load_data(DATASET_DIR%2C%20LABELS)%0A%0A%20%20%20%20mo.stop(data.empty%2C%20mo.md(%22**Error**%3A%20No%20data%20was%20loaded.%20Exiting!%22))%0A%20%20%20%20mo.output.append(%0A%20%20%20%20%20%20%20%20mo.md(f%22Successfully%20loaded%20and%20processed%20**%7Blen(data)%7D**%20samples.%22)%0A%20%20%20%20)%0A%20%20%20%20return%20LABELS%2C%20data%0A%0A%0A%40app.cell%0Adef%20_(data)%3A%0A%20%20%20%20X%20%3D%20data.drop(%22label%22%2C%20axis%3D1)%0A%20%20%20%20y%20%3D%20data%5B%22label%22%5D%0A%0A%20%20%20%20%23%20scale%20features%0A%20%20%20%20%23%20this%20is%20important%20for%20SVM%2C%20but%20also%20good%20practice%20for%20most%20models%0A%20%20%20%20%23%20scaler%20%3D%20StandardScaler()%0A%0A%20%20%20%20X_train%2C%20X_test%2C%20y_train%2C%20y_test%20%3D%20train_test_split(%0A%20%20%20%20%20%20%20%20X%2C%0A%20%20%20%20%20%20%20%20y%2C%0A%20%20%20%20%20%20%20%20test_size%3D0.2%2C%0A%20%20%20%20%20%20%20%20random_state%3D42%2C%0A%20%20%20%20%20%20%20%20stratify%3Dy%2C%20%20%23%20to%20ensure%20all%20classes%20are%20represented%20in%20train%2Ftest%20splits%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20X_train%20%3D%20scaler.fit_transform(X_train)%0A%20%20%20%20%23%20X_test%20%3D%20scaler.transform(X_test)%0A%20%20%20%20return%20X%2C%20X_test%2C%20X_train%2C%20y_test%2C%20y_train%0A%0A%0A%40app.cell%0Adef%20_(X)%3A%0A%20%20%20%20X%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20y_train)%3A%0A%20%20%20%20mo.output.append(%22Training%20Random%20Forest%20classifier...%22)%0A%20%20%20%20model%20%3D%20RandomForestClassifier(n_estimators%3D100%2C%20random_state%3D42)%0A%20%20%20%20%23%20print(%22Training%20SVM%20classifier...%22)%0A%20%20%20%20%23%20model%20%3D%20SVC(kernel%3D'rbf'%2C%20probability%3DTrue%2C%20random_state%3D42)%0A%20%20%20%20model.fit(X_train%2C%20y_train)%0A%20%20%20%20mo.output.append(%22Training%20complete.%22)%0A%20%20%20%20return%20(model%2C)%0A%0A%0A%40app.cell%0Adef%20_(X_test%2C%20model%2C%20y_test)%3A%0A%20%20%20%20y_pred%20%3D%20model.predict(X_test)%0A%20%20%20%20acc%20%3D%20accuracy_score(y_test%2C%20y_pred)%0A%20%20%20%20mo.output.append(mo.md(f%22Model%20Accuracy%3A%20**%7Bacc%20*%20100%3A.2f%7D%25**%22))%0A%20%20%20%20return%20(y_pred%2C)%0A%0A%0A%40app.cell%0Adef%20_(LABELS%2C%20y_pred%2C%20y_test)%3A%0A%20%20%20%20mo.output.append(mo.md(%22**Classification%20Report%3A**%22))%0A%20%20%20%20print(classification_report(y_test%2C%20y_pred%2C%20labels%3DLABELS))%0A%20%20%20%20return%0A%0A%0A%40app.function%0Adef%20find_all_contours(thresholded_image)%3A%0A%20%20%20%20contours%2C%20_%20%3D%20cv2.findContours(%0A%20%20%20%20%20%20%20%20thresholded_image%2C%20cv2.RETR_EXTERNAL%2C%20cv2.CHAIN_APPROX_SIMPLE%0A%20%20%20%20)%0A%0A%20%20%20%20filtered_contours%20%3D%20%5B%0A%20%20%20%20%20%20%20%20contour%20for%20contour%20in%20contours%20if%20cv2.contourArea(contour)%20%3E%3D%20100%0A%20%20%20%20%5D%0A%0A%20%20%20%20return%20filtered_contours%0A%0A%0A%40app.function%0Adef%20extract_features_from_all_shapes(image_path%2C%20threshold_value%3DNone)%3A%0A%20%20%20%20feature_names%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22num_corners%22%2C%0A%20%20%20%20%20%20%20%20%22solidity%22%2C%0A%20%20%20%20%20%20%20%20%22aspect_ratio%22%2C%0A%20%20%20%20%20%20%20%20%22circularity%22%2C%0A%20%20%20%20%20%20%20%20%22hu1%22%2C%0A%20%20%20%20%20%20%20%20%22hu2%22%2C%0A%20%20%20%20%20%20%20%20%22hu3%22%2C%0A%20%20%20%20%20%20%20%20%22hu4%22%2C%0A%20%20%20%20%20%20%20%20%22hu5%22%2C%0A%20%20%20%20%20%20%20%20%22hu6%22%2C%0A%20%20%20%20%20%20%20%20%22hu7%22%2C%0A%20%20%20%20%5D%0A%0A%20%20%20%20thresholded_image%20%3D%20preprocessing(image_path%2C%20threshold_value)%0A%20%20%20%20contours%20%3D%20find_all_contours(thresholded_image)%0A%20%20%20%20mo.output.append(f%22Found%20%7Blen(contours)%7D%20contours%20in%20the%20image.%22)%0A%0A%20%20%20%20if%20len(contours)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20all_contours_features%20%3D%20%5B%5D%0A%20%20%20%20for%20contour%20in%20contours%3A%0A%20%20%20%20%20%20%20%20all_contours_features.append(extract_features_from_contour(contour))%0A%0A%20%20%20%20df%20%3D%20pd.DataFrame(all_contours_features%2C%20columns%3Dfeature_names)%0A%0A%20%20%20%20return%20df%0A%0A%0A%40app.cell%0Adef%20_(model)%3A%0A%20%20%20%20multi_shape_image%20%3D%20mo.notebook_dir()%20%2F%20%22shapes_used.jpeg%22%0A%20%20%20%20all_shapes_features%20%3D%20extract_features_from_all_shapes(%0A%20%20%20%20%20%20%20%20multi_shape_image%2C%20threshold_value%3D250%0A%20%20%20%20)%0A%20%20%20%20predicted_shapes%20%3D%20model.predict(all_shapes_features)%0A%20%20%20%20Counter(predicted_shapes)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">9653f3125fdd6f2ea8c4c08831a75de69b88f570c194297ec34da973ec5a0709</marimo-code-hash>
</body>
</html>
